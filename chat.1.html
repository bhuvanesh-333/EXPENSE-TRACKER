<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Expense Tracker</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(to right, #ffecd2, #fcb69f);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
    }
    .container {
      background: #fff;
      border-radius: 15px;
      box-shadow: 0 8px 16px rgba(0,0,0,0.2);
      padding: 25px;
      width: 400px;
      text-align: center;
      animation: fadeIn 0.7s ease-in-out;
    }
    h2 {
      color: #333;
      margin-bottom: 20px;
    }
    input {
      width: 90%;
      padding: 10px;
      margin: 10px 0;
      border: 2px solid #ddd;
      border-radius: 8px;
      font-size: 14px;
    }
    button {
      background: #ff6f61;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      transition: background 0.3s;
    }
    button:hover {
      background: #e65b4f;
    }
    .hidden {
      display: none;
    }
    ul {
      list-style: none;
      padding: 0;
    }
    li {
      background: #f4f4f4;
      margin: 8px 0;
      padding: 10px;
      border-radius: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .delete {
      color: red;
      cursor: pointer;
      font-weight: bold;
    }
    canvas {
      margin-top: 20px;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <div class="container" id="loginPage">
    <h2>Login</h2>
    <input type="text" id="loginUser" placeholder="Username" required>
    <input type="password" id="loginPass" placeholder="Password" required>
    <button onclick="login()">Login</button>
    <p>Don't have an account? <a href="#" onclick="showSignup()">Signup</a></p>
  </div>

  <div class="container hidden" id="signupPage">
    <h2>Signup</h2>
    <input type="text" id="signupUser" placeholder="Choose Username" required>
    <input type="password" id="signupPass" placeholder="Choose Password" required>
    <button onclick="signup()">Signup</button>
    <p>Already have an account? <a href="#" onclick="showLogin()">Login</a></p>
  </div>

  <div class="container hidden" id="trackerPage">
    <h2>Expense Tracker</h2>
    <input type="text" id="expenseName" placeholder="Expense Name">
    <input type="number" id="expenseAmount" placeholder="Amount">
    <button onclick="addExpense()">Add Expense</button>
    
    <h3>Expense List</h3>
    <ul id="expenseList"></ul>
    <h3>Total: ₹<span id="total">0</span></h3>

    <canvas id="expenseChart" width="300" height="300"></canvas>
    <br>
    <button onclick="logout()">Logout</button>
  </div>

  <script>
    // Store users
    let users = JSON.parse(localStorage.getItem("users")) || [];
    let currentUser = null;
    let expenses = [];

    function showSignup() {
      document.getElementById("loginPage").classList.add("hidden");
      document.getElementById("signupPage").classList.remove("hidden");
    }

    function showLogin() {
      document.getElementById("signupPage").classList.add("hidden");
      document.getElementById("loginPage").classList.remove("hidden");
    }

    function signup() {
      let user = document.getElementById("signupUser").value;
      let pass = document.getElementById("signupPass").value;

      if (user && pass) {
        users.push({ username: user, password: pass });
        localStorage.setItem("users", JSON.stringify(users));
        alert("Signup successful! Please login.");
        showLogin();
      } else {
        alert("Fill all fields!");
      }
    }

    function login() {
      let user = document.getElementById("loginUser").value;
      let pass = document.getElementById("loginPass").value;

      let found = users.find(u => u.username === user && u.password === pass);
      if (found) {
        currentUser = user;
        document.getElementById("loginPage").classList.add("hidden");
        document.getElementById("trackerPage").classList.remove("hidden");
        expenses = JSON.parse(localStorage.getItem(currentUser + "_expenses")) || [];
        renderExpenses();
      } else {
        alert("Invalid username or password!");
      }
    }

    function logout() {
      currentUser = null;
      document.getElementById("trackerPage").classList.add("hidden");
      document.getElementById("loginPage").classList.remove("hidden");
    }

    function addExpense() {
      let name = document.getElementById("expenseName").value;
      let amount = parseInt(document.getElementById("expenseAmount").value);

      if (name && amount) {
        expenses.push({ name, amount });
        localStorage.setItem(currentUser + "_expenses", JSON.stringify(expenses));
        document.getElementById("expenseName").value = "";
        document.getElementById("expenseAmount").value = "";
        renderExpenses();
      } else {
        alert("Enter valid expense!");
      }
    }

    function deleteExpense(index) {
      expenses.splice(index, 1);
      localStorage.setItem(currentUser + "_expenses", JSON.stringify(expenses));
      renderExpenses();
    }

    function renderExpenses() {
      let list = document.getElementById("expenseList");
      list.innerHTML = "";
      let total = 0;

      expenses.forEach((exp, i) => {
        let li = document.createElement("li");
        li.innerHTML = `${exp.name} - ₹${exp.amount} <span class="delete" onclick="deleteExpense(${i})">X</span>`;
        list.appendChild(li);
        total += exp.amount;
      });

      document.getElementById("total").innerText = total;
      drawChart();
    }

    function drawChart() {
      let ctx = document.getElementById("expenseChart").getContext("2d");
      let labels = expenses.map(e => e.name);
      let data = expenses.map(e => e.amount);

      if (window.expenseChartInstance) {
        window.expenseChartInstance.destroy();
      }

      window.expenseChartInstance = new Chart(ctx, {
        type: "pie",
        data: {
          labels: labels,
          datasets: [{
            data: data,
            backgroundColor: ["#ff6f61", "#6a89cc", "#38ada9", "#e58e26", "#b71540", "#78e08f"]
          }]
        }
      });
    }
  </script>
</body>
</html>
